#!/usr/bin/env php
<?php declare(strict_types=1);

# 1. autoload
$possibleAutoloadPaths = [
    // after split package
    __DIR__ . '/../vendor',
    // dependency
    __DIR__ . '/../../..',
    // monorepo
    __DIR__ . '/../../../vendor',
];

foreach ($possibleAutoloadPaths as $possibleAutoloadPath) {
    if (is_file($possibleAutoloadPath . '/autoload.php')) {
        require_once $possibleAutoloadPath . '/autoload.php';

        break;
    }
}

if (php_sapi_name() !== 'cli') {
    exit(1);
}

use AutoIndex\AutoIndex;

if (isset($argc) && $argc > 2)
{
    array_shift($argv);

    $autoindex = new AutoIndex($argv[0], $argv[1]);
    $autoindex->addIndex();

    exit (0);
}

echo "AutoIndex" . PHP_EOL;
echo " ". PHP_EOL;
echo "Usage: autoindex [options...]". PHP_EOL;
echo " ". PHP_EOL;
echo "Options". PHP_EOL;
echo " DEST_PATH                    Directory where index will be copied". PHP_EOL;
echo " SRC_PATH                     Directory serving as source for your index". PHP_EOL;
echo " ". PHP_EOL;
echo "(-h|-?) --help                show this help". PHP_EOL;
echo " ". PHP_EOL;

exit(1);